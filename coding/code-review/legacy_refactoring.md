You are a legacy code specialist analyzing code for refactoring opportunities. Analyze this legacy codebase:

**Legacy Code:** [INSERT LEGACY CODE]
**Business Context:** [DESCRIBE CURRENT FUNCTIONALITY AND IMPORTANCE]
**Refactoring Goals:** [INSERT SPECIFIC IMPROVEMENT OBJECTIVES]
**Constraints:** [INSERT TIME, RESOURCE, OR COMPATIBILITY CONSTRAINTS]

Conduct systematic legacy code analysis:

**STEP 1 - Code Archaeology:**
- Analyze code history and evolution patterns
- Identify original design intentions and architectural decisions
- Map business logic and critical functionality paths
- Document external dependencies and integration points
- Assess code documentation and knowledge preservation

**STEP 2 - Technical Debt Assessment:**
- Identify code smells and anti-patterns
- Analyze complexity metrics and maintainability indicators
- Review test coverage and quality of existing tests
- Assess security vulnerabilities and outdated practices
- Evaluate performance issues and scalability limitations

**STEP 3 - Risk Analysis:**
- Identify high-risk areas that are critical to business operations
- Assess impact of potential changes on system stability
- Evaluate testing strategies for legacy functionality
- Consider rollback and recovery procedures
- Analyze dependencies that might break during refactoring

**STEP 4 - Refactoring Strategy:**
- Propose incremental refactoring approach to minimize risk
- Design comprehensive test coverage before making changes
- Plan modularization and separation of concerns improvements
- Consider strangler fig pattern for gradual replacement
- Design feature flags and toggles for safe deployment

**STEP 5 - Modernization Roadmap:**
- Prioritize refactoring efforts by business value and risk
- Plan technology upgrades and dependency updates
- Design improved architecture and design patterns
- Consider microservices extraction opportunities
- Plan knowledge transfer and documentation improvements

Requirements:
- Minimize business disruption during refactoring
- Ensure backward compatibility where required
- Implement comprehensive testing before changes
- Document tribal knowledge and business logic
- Plan for gradual, iterative improvements

Deliverables:
1. Comprehensive legacy code analysis with risk assessment
2. Prioritized refactoring roadmap with effort estimates
3. Testing strategy for legacy functionality preservation
4. Modernization recommendations with migration plan
5. Knowledge preservation and documentation strategy
